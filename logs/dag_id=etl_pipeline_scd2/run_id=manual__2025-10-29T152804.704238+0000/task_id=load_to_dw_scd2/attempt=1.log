[2025-10-29T15:38:20.148+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: etl_pipeline_scd2.load_to_dw_scd2 manual__2025-10-29T15:28:04.704238+00:00 [queued]>
[2025-10-29T15:38:20.226+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: etl_pipeline_scd2.load_to_dw_scd2 manual__2025-10-29T15:28:04.704238+00:00 [queued]>
[2025-10-29T15:38:20.228+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 1
[2025-10-29T15:38:20.323+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): load_to_dw_scd2> on 2025-10-29 15:28:04.704238+00:00
[2025-10-29T15:38:20.352+0000] {standard_task_runner.py:60} INFO - Started process 394 to run task
[2025-10-29T15:38:20.363+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'etl_pipeline_scd2', 'load_to_dw_scd2', 'manual__2025-10-29T15:28:04.704238+00:00', '--job-id', '255', '--raw', '--subdir', 'DAGS_FOLDER/process_scripts.py', '--cfg-path', '/tmp/tmpnfocz41g']
[2025-10-29T15:38:20.531+0000] {standard_task_runner.py:88} INFO - Job 255: Subtask load_to_dw_scd2
[2025-10-29T15:38:20.819+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.11/site-packages/***/settings.py:194 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-10-29T15:38:21.328+0000] {task_command.py:423} INFO - Running <TaskInstance: etl_pipeline_scd2.load_to_dw_scd2 manual__2025-10-29T15:28:04.704238+00:00 [running]> on host b5b5035930e9
[2025-10-29T15:38:21.609+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='etl_pipeline_scd2' AIRFLOW_CTX_TASK_ID='load_to_dw_scd2' AIRFLOW_CTX_EXECUTION_DATE='2025-10-29T15:28:04.704238+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-10-29T15:28:04.704238+00:00'
[2025-10-29T15:38:25.227+0000] {scd2_loader.py:312} INFO - Traitement dynamique du fichier: Country_code_20251029.xlsx pour map_key=country_code
[2025-10-29T15:38:27.098+0000] {scd2_loader.py:365} WARNING - 1 lignes ignorées (clés manquantes) dans Country_code_20251029.xlsx::Sheet1
[2025-10-29T15:38:27.635+0000] {scd2_loader.py:146} INFO - Table `dim_pays` créée avec clés uniques: `country_code`
[2025-10-29T15:38:27.791+0000] {scd2_loader.py:280} INFO - [SCD2] dim_pays → inserts=34, updates_closed=0
[2025-10-29T15:38:27.792+0000] {scd2_loader.py:312} INFO - Traitement dynamique du fichier: Extract_Station_20251029.xlsx pour map_key=extract_station
[2025-10-29T15:38:28.725+0000] {scd2_loader.py:365} WARNING - 2 lignes ignorées (clés manquantes) dans Extract_Station_20251029.xlsx::Sheet1
[2025-10-29T15:38:28.775+0000] {scd2_loader.py:183} INFO - Pour dim_stations on utilise la clé calculée 'uniq_business'
[2025-10-29T15:38:28.789+0000] {scd2_loader.py:191} WARNING - 739 lignes ignorées dans dim_stations (clés manquantes ou doublons)
[2025-10-29T15:38:28.925+0000] {scd2_loader.py:146} INFO - Table `dim_stations` créée avec clés uniques: `uniq_business`
[2025-10-29T15:38:30.397+0000] {scd2_loader.py:280} INFO - [SCD2] dim_stations → inserts=4419, updates_closed=0
[2025-10-29T15:38:30.402+0000] {scd2_loader.py:312} INFO - Traitement dynamique du fichier: Inspections_20250815.xlsx pour map_key=inspections
[2025-10-29T15:38:30.603+0000] {scd2_loader.py:191} WARNING - 71 lignes ignorées dans fact_inspections (clés manquantes ou doublons)
[2025-10-29T15:38:30.622+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('KE', 'ACE')
[2025-10-29T15:38:30.630+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('ZW', 'ACE')
[2025-10-29T15:38:30.643+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('TN', 'MOI')
[2025-10-29T15:38:30.652+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('TZ', 'ACE')
[2025-10-29T15:38:30.665+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('CI', 'AFO')
[2025-10-29T15:38:30.667+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('YT', 'MOI')
[2025-10-29T15:38:30.672+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('TG', 'AFO')
[2025-10-29T15:38:30.674+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('SZ', 'AFA')
[2025-10-29T15:38:30.677+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('CD', 'ACE')
[2025-10-29T15:38:30.687+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('ZM', 'ACE')
[2025-10-29T15:38:30.703+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('SN', 'AFO')
[2025-10-29T15:38:30.723+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('MW', 'ACE')
[2025-10-29T15:38:30.729+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('ZA', 'AFA')
[2025-10-29T15:38:30.735+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('NG', 'NIGERIA')
[2025-10-29T15:38:30.743+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('GA', 'AFO')
[2025-10-29T15:38:30.758+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('RE', 'MOI')
[2025-10-29T15:38:30.764+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('UG', 'ACE')
[2025-10-29T15:38:30.776+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('GH', 'AFO')
[2025-10-29T15:38:30.778+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('CM', 'AFO')
[2025-10-29T15:38:30.793+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('BF', 'AFO')
[2025-10-29T15:38:30.804+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('MA', 'MOI')
[2025-10-29T15:38:30.815+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('GN', 'AFO')
[2025-10-29T15:38:30.826+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('MU', 'MOI')
[2025-10-29T15:38:30.835+0000] {scd2_loader.py:235} INFO - Doublon ignoré pour fact_inspections clé=('ET', 'MOI')
[2025-10-29T15:38:30.841+0000] {scd2_loader.py:280} INFO - [SCD2] fact_inspections → inserts=0, updates_closed=0
[2025-10-29T15:38:30.848+0000] {scd2_loader.py:312} INFO - Traitement dynamique du fichier: Invariants_details_20251029.xlsx pour map_key=invariants_details
[2025-10-29T15:38:52.246+0000] {scd2_loader.py:351} INFO - Colonne 'status' transformée: Compliant=100, Non compliant=0, N/A=NULL, vide=NULL
[2025-10-29T15:38:52.418+0000] {scd2_loader.py:191} WARNING - 86596 lignes ignorées dans dim_invariants_details (clés manquantes ou doublons)
[2025-10-29T15:38:52.864+0000] {scd2_loader.py:146} INFO - Table `dim_invariants_details` créée avec clés uniques: `country_code`, `cost_center`
[2025-10-29T15:38:53.920+0000] {scd2_loader.py:280} INFO - [SCD2] dim_invariants_details → inserts=3573, updates_closed=0
[2025-10-29T15:38:53.931+0000] {scd2_loader.py:312} INFO - Traitement dynamique du fichier: Invariants_study_20251029.xlsx pour map_key=invariants_study
[2025-10-29T15:39:12.884+0000] {scd2_loader.py:191} WARNING - 89336 lignes ignorées dans dim_invariants (clés manquantes ou doublons)
[2025-10-29T15:39:13.021+0000] {scd2_loader.py:146} INFO - Table `dim_invariants` créée avec clés uniques: `country_code`, `invariant`
[2025-10-29T15:39:13.332+0000] {scd2_loader.py:280} INFO - [SCD2] dim_invariants → inserts=833, updates_closed=0
[2025-10-29T15:39:13.334+0000] {scd2_loader.py:312} INFO - Traitement dynamique du fichier: Invariants_study_enriched_20251029.xlsx pour map_key=invariants_study_enriched
[2025-10-29T15:39:26.682+0000] {scd2_loader.py:191} WARNING - 89411 lignes ignorées dans dim_invariants_enriched (clés manquantes ou doublons)
[2025-10-29T15:39:27.016+0000] {scd2_loader.py:146} INFO - Table `dim_invariants_enriched` créée avec clés uniques: `country_code`, `invariant`
[2025-10-29T15:39:27.299+0000] {scd2_loader.py:280} INFO - [SCD2] dim_invariants_enriched → inserts=758, updates_closed=0
[2025-10-29T15:39:27.313+0000] {scd2_loader.py:372} INFO - FIN CHARGEMENT DYNAMIQUE — inserts=9617, updates_closed=0
[2025-10-29T15:39:27.352+0000] {python.py:201} INFO - Done. Returned value was: None
[2025-10-29T15:39:27.401+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=etl_pipeline_scd2, task_id=load_to_dw_scd2, execution_date=20251029T152804, start_date=20251029T153820, end_date=20251029T153927
[2025-10-29T15:39:27.879+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-10-29T15:39:28.198+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
