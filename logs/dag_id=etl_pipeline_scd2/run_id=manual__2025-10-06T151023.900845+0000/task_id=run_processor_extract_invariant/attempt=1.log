[2025-10-06T15:10:37.400+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: etl_pipeline_scd2.run_processor_extract_invariant manual__2025-10-06T15:10:23.900845+00:00 [queued]>
[2025-10-06T15:10:37.409+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: etl_pipeline_scd2.run_processor_extract_invariant manual__2025-10-06T15:10:23.900845+00:00 [queued]>
[2025-10-06T15:10:37.410+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 1
[2025-10-06T15:10:37.436+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): run_processor_extract_invariant> on 2025-10-06 15:10:23.900845+00:00
[2025-10-06T15:10:37.453+0000] {standard_task_runner.py:60} INFO - Started process 1067 to run task
[2025-10-06T15:10:37.461+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'etl_pipeline_scd2', 'run_processor_extract_invariant', 'manual__2025-10-06T15:10:23.900845+00:00', '--job-id', '171', '--raw', '--subdir', 'DAGS_FOLDER/process_scripts.py', '--cfg-path', '/tmp/tmpvdvwfbh5']
[2025-10-06T15:10:37.471+0000] {standard_task_runner.py:88} INFO - Job 171: Subtask run_processor_extract_invariant
[2025-10-06T15:10:37.520+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.11/site-packages/***/settings.py:194 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-10-06T15:10:37.616+0000] {task_command.py:423} INFO - Running <TaskInstance: etl_pipeline_scd2.run_processor_extract_invariant manual__2025-10-06T15:10:23.900845+00:00 [running]> on host 548a0c322259
[2025-10-06T15:10:37.728+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='etl_pipeline_scd2' AIRFLOW_CTX_TASK_ID='run_processor_extract_invariant' AIRFLOW_CTX_EXECUTION_DATE='2025-10-06T15:10:23.900845+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-10-06T15:10:23.900845+00:00'
[2025-10-06T15:11:03.373+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/operators/python.py", line 199, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/operators/python.py", line 216, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/process_scripts.py", line 20, in run_script
    raise Exception(f"Script {script_path} failed\nSTDOUT:{result.stdout}\nSTDERR:{result.stderr}")
Exception: Script /opt/***/scripts/processor_extract_invariant.py failed
STDOUT:[SKIP] sheet='Hypothèse ' non autorisé
[SKIP] sheet='PLT 24-30 (Old zones)' non autorisé
[SKIP] sheet='besoin Capex Vs PLT 2024' non autorisé
[SKIP] sheet='REPORTING_AFR' non autorisé
[SKIP] sheet='conformité_BUvsPC_2021' non autorisé
[SKIP] sheet='CAD 24' non autorisé
[SKIP] sheet='REPORTING_AFR_17.07.25' non autorisé
[SKIP] sheet='Pu_filiale' non autorisé
[SKIP] sheet='REPORTING_MKRD_01.24' non autorisé
[SKIP] sheet='AFR' non autorisé
[SKIP] sheet='AFR 2026' non autorisé
[SKIP] sheet='BU AFR' non autorisé
[SKIP] sheet='BU_NIG' non autorisé
[SKIP] sheet='BU_MOI' non autorisé
[SKIP] sheet='BU_ANBE' non autorisé
[SKIP] sheet='BU_AFO' non autorisé
[SKIP] sheet='BU_ACE' non autorisé
[SKIP] sheet='AFR (PC)' non autorisé
[SKIP] sheet='NIG' non autorisé
[SKIP] sheet='MOI (PC)' non autorisé
[SKIP] sheet='MOI' non autorisé
[SKIP] sheet='AFO (PC)' non autorisé
[SKIP] sheet='AFO' non autorisé
[SKIP] sheet='ACE (PC)' non autorisé
[SKIP] sheet='ACE' non autorisé
[SKIP] sheet='AFA (PC)' non autorisé
[SKIP] sheet='ANBE' non autorisé
[OK] sheet='Nigéria' traité
[OK] sheet='Mayotte' traité
[OK] sheet='Egypte' traité
[OK] sheet='Erythrée' traité
[OK] sheet='Ethiopie' traité
[OK] sheet='Madagascar' traité
[OK] sheet='Maroc' traité
[OK] sheet='Maurice' traité
[OK] sheet='Réunion' traité
[OK] sheet='Tunisie' traité
[SKIP] sheet='Burkina' -> Aucun bloc d'invariant significatif détecté
[OK] sheet='Togo' traité
[OK] sheet='Tchad' traité
[OK] sheet='Sénégal' traité
[OK] sheet='Mali' traité
[OK] sheet='Ghana' traité
[OK] sheet='Centafrique' traité
[OK] sheet='Côte Ivoire' traité
[OK] sheet='Guinée' traité
[OK] sheet='Botswana' traité
[OK] sheet='Afrique du Sud' traité
[OK] sheet='Eswatini' traité
[OK] sheet='Malawi' traité
[OK] sheet='Angola' traité
[OK] sheet='Mozambique' traité
[OK] sheet='Namibie' traité
[OK] sheet='Zimbabwe' traité
[OK] sheet='Zambie' traité
[OK] sheet='Cameroun' traité
[OK] sheet='RDC' traité
[OK] sheet='Congo Brazza' traité
[OK] sheet='Gabon' traité
[OK] sheet='Guinée Equitoriale' traité
[OK] sheet='Kenya' traité
[SKIP] sheet='Uganda' -> Aucun bloc d'invariant significatif détecté
[OK] sheet='Tanzania' traité
[SKIP] sheet='nbr site 100% conforme' non autorisé
[SKIP] sheet='Comparaison nbre sites' non autorisé
[SKIP] sheet='Bridge_nbre station 2022 ' non autorisé
[SKIP] sheet='Bridge_nbre station 2023' non autorisé

STDERR:/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:310: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  df_all = pd.concat(df_parts, ignore_index=True, sort=False).applymap(
/opt/***/scripts/processor_extract_invariant.py:310: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_all = pd.concat(df_parts, ignore_index=True, sort=False).applymap(
Traceback (most recent call last):
  File "/opt/***/scripts/processor_extract_invariant.py", line 366, in <module>
    p1, p2 = process_workbook_all_sheets_to_two_files(INPUT_FILE, output_prefix=OUTPUT_PREFIX)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/***/scripts/processor_extract_invariant.py", line 314, in process_workbook_all_sheets_to_two_files
    df_file1 = df_all[["Study Domain", "Invariant", "Country code","Cost Center"]].copy().set_index("Code du pays")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.11/site-packages/pandas/core/frame.py", line 5870, in set_index
    raise KeyError(f"None of {missing} are in the columns")
KeyError: "None of ['Code du pays'] are in the columns"

[2025-10-06T15:11:03.416+0000] {taskinstance.py:1138} INFO - Marking task as FAILED. dag_id=etl_pipeline_scd2, task_id=run_processor_extract_invariant, execution_date=20251006T151023, start_date=20251006T151037, end_date=20251006T151103
[2025-10-06T15:11:03.456+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 171 for task run_processor_extract_invariant (Script /opt/***/scripts/processor_extract_invariant.py failed
STDOUT:[SKIP] sheet='Hypothèse ' non autorisé
[SKIP] sheet='PLT 24-30 (Old zones)' non autorisé
[SKIP] sheet='besoin Capex Vs PLT 2024' non autorisé
[SKIP] sheet='REPORTING_AFR' non autorisé
[SKIP] sheet='conformité_BUvsPC_2021' non autorisé
[SKIP] sheet='CAD 24' non autorisé
[SKIP] sheet='REPORTING_AFR_17.07.25' non autorisé
[SKIP] sheet='Pu_filiale' non autorisé
[SKIP] sheet='REPORTING_MKRD_01.24' non autorisé
[SKIP] sheet='AFR' non autorisé
[SKIP] sheet='AFR 2026' non autorisé
[SKIP] sheet='BU AFR' non autorisé
[SKIP] sheet='BU_NIG' non autorisé
[SKIP] sheet='BU_MOI' non autorisé
[SKIP] sheet='BU_ANBE' non autorisé
[SKIP] sheet='BU_AFO' non autorisé
[SKIP] sheet='BU_ACE' non autorisé
[SKIP] sheet='AFR (PC)' non autorisé
[SKIP] sheet='NIG' non autorisé
[SKIP] sheet='MOI (PC)' non autorisé
[SKIP] sheet='MOI' non autorisé
[SKIP] sheet='AFO (PC)' non autorisé
[SKIP] sheet='AFO' non autorisé
[SKIP] sheet='ACE (PC)' non autorisé
[SKIP] sheet='ACE' non autorisé
[SKIP] sheet='AFA (PC)' non autorisé
[SKIP] sheet='ANBE' non autorisé
[OK] sheet='Nigéria' traité
[OK] sheet='Mayotte' traité
[OK] sheet='Egypte' traité
[OK] sheet='Erythrée' traité
[OK] sheet='Ethiopie' traité
[OK] sheet='Madagascar' traité
[OK] sheet='Maroc' traité
[OK] sheet='Maurice' traité
[OK] sheet='Réunion' traité
[OK] sheet='Tunisie' traité
[SKIP] sheet='Burkina' -> Aucun bloc d'invariant significatif détecté
[OK] sheet='Togo' traité
[OK] sheet='Tchad' traité
[OK] sheet='Sénégal' traité
[OK] sheet='Mali' traité
[OK] sheet='Ghana' traité
[OK] sheet='Centafrique' traité
[OK] sheet='Côte Ivoire' traité
[OK] sheet='Guinée' traité
[OK] sheet='Botswana' traité
[OK] sheet='Afrique du Sud' traité
[OK] sheet='Eswatini' traité
[OK] sheet='Malawi' traité
[OK] sheet='Angola' traité
[OK] sheet='Mozambique' traité
[OK] sheet='Namibie' traité
[OK] sheet='Zimbabwe' traité
[OK] sheet='Zambie' traité
[OK] sheet='Cameroun' traité
[OK] sheet='RDC' traité
[OK] sheet='Congo Brazza' traité
[OK] sheet='Gabon' traité
[OK] sheet='Guinée Equitoriale' traité
[OK] sheet='Kenya' traité
[SKIP] sheet='Uganda' -> Aucun bloc d'invariant significatif détecté
[OK] sheet='Tanzania' traité
[SKIP] sheet='nbr site 100% conforme' non autorisé
[SKIP] sheet='Comparaison nbre sites' non autorisé
[SKIP] sheet='Bridge_nbre station 2022 ' non autorisé
[SKIP] sheet='Bridge_nbre station 2023' non autorisé

STDERR:/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:184: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_raw = df_raw.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:188: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  data = data.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:193: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  station_block = station_block.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:201: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  remainder = remainder.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA,
/opt/***/scripts/processor_extract_invariant.py:271: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_out = df_out.applymap(lambda x: x.strip() if isinstance(x, str) else x).replace(r'^\s*$', pd.NA, regex=True)
/opt/***/scripts/processor_extract_invariant.py:310: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  df_all = pd.concat(df_parts, ignore_index=True, sort=False).applymap(
/opt/***/scripts/processor_extract_invariant.py:310: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  df_all = pd.concat(df_parts, ignore_index=True, sort=False).applymap(
Traceback (most recent call last):
  File "/opt/***/scripts/processor_extract_invariant.py", line 366, in <module>
    p1, p2 = process_workbook_all_sheets_to_two_files(INPUT_FILE, output_prefix=OUTPUT_PREFIX)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/***/scripts/processor_extract_invariant.py", line 314, in process_workbook_all_sheets_to_two_files
    df_file1 = df_all[["Study Domain", "Invariant", "Country code","Cost Center"]].copy().set_index("Code du pays")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/***/.local/lib/python3.11/site-packages/pandas/core/frame.py", line 5870, in set_index
    raise KeyError(f"None of {missing} are in the columns")
KeyError: "None of ['Code du pays'] are in the columns"
; 1067)
[2025-10-06T15:11:03.517+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-10-06T15:11:03.566+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
